\section{Reeb graph}

\subsection{Definition}
\begin{frame*}
Given:
\begin{itemize}
\item a manifold $\mathcal{M}$;
\item a Morse function $\map{f}{\mathcal{M}}{\RR}$ with distinct critical values;
\end{itemize}
the \defterm{Reeb graph} of $f$ is the $1$-dimensional simplicial complex
\[
\mathcal{R}(f)=\mathcal{M}/\sidenote[text height=height("I"))]{\sim}{\draw node[draw,circle,inner sep=5pt] (source)  {} node[text width=4cm,anchor=north west] (target) at (.3,-.3) {$x\sim y$ if $f(x)=f(y)$ and they belong to the same connected component of $f^{-1}(f(x))$} (source) to[out=-90,in=170] ([yshift=-7pt]target.north west);}.
\]
The \defterm{segmentation map} is the quotient map
\[
\map{\Phi}{\mathcal{M}}{\mathcal{R}(f)}.
\]
\begin{center}
\begin{tikzpicture}
\path (-1,-.1) rectangle (6.5,3.0);
\begin{scope}[small,transform canvas={scale=.5}]
\draw[-{Latex[scale=2]}] (-11,0) to node[left,scale=2] {$f$} (-11,25);
\draw[-{Classical TikZ Rightarrow[scale=2]}] (20,12.5) -- node[above,scale=2] {$\Phi$} (27,12.5);
\pic{reeb graph={manifold 1,manifold bg,
partial edge={12}{}{absolute up to={19}{\draw[\thiscolor,line width=2pt,dashed,opacity=.5] (.1,0) arc(0:180:1.6 and .5);\draw[\thiscolor,line width=2pt] (.1,0) arc (0:-180:1.6 and .5);}},
partial edge={11}{}{absolute up to={19}{\draw[\thiscolor,line width=2pt,dashed,opacity=.5] (1.5,0) arc(0:180:1.5 and .5);\draw[\thiscolor,line width=2pt] (1.5,0) arc (0:-180:1.5 and .5);}},
partial edge={10}{}{absolute up to={19}{\draw[\thiscolor,line width=2pt,dashed,opacity=.5] (2.0,0) arc(0:180:1.2 and .5);\draw[\thiscolor,line width=2pt] (2.0,0) arc(0:-180:1.2 and .5);}},
}};
\begin{scope}[xshift=8cm]
\pic{reeb graph={manifold 1,every edge={preaction={draw=black,line width=3pt},draw=gray!40,line width=2pt},every node={\draw[black,line width=1pt,fill=white] circle(3pt);},
partial edge={12}{}{absolute up to={19}{\fill[\thiscolor] circle(3pt);}},
partial edge={11}{}{absolute up to={19}{\fill[\thiscolor] circle(3pt);}},
partial edge={10}{}{absolute up to={19}{\fill[\thiscolor] circle(3pt);}},
}};
\end{scope}
\end{scope}
\end{tikzpicture}
\end{center}

\end{frame*}

\subsection*{Desired algorithm}
\begin{frame*}
\textbf{Input:}
\begin{itemize}
\item \textcolor{gray}{a PL manifold $\mathcal{M}$}\\
$\leadsto$ a triangulated mesh $\mathcal{M}$;
\item \textcolor{gray}{a non-degenerate PL scalar field $f$ on $\mathcal{M}$}\\
$\leadsto$ a \sidenotehighlight{scalar value}{\draw node[anchor=north west,text width=4cm] (target) at (.5, -.3) {pairwise different, in order to ensure non-degeneracy; this can be achieved by random perturbations} (mymark) to[out=-90,in=170] ([yshift=-7pt]target.north west);} $f(v)$ for each vertex $v$ of $\mathcal{M}$.
\end{itemize}
\vspace{.4cm}
\textbf{Output:}
\begin{itemize}
\item the \sidenotehighlight{augmented}{\draw node[anchor=north west] (target) at (.5,-.3) {graph $+$ segmentation map} (mymark) to[out=-90,in=170] ([yshift=-7pt]target.north west);} Reeb graph $\mathcal{R}(f)$.
\end{itemize}
\vspace{.4cm}
\textbf{Time complexity:}
\begin{itemize}
\item $O(m\cdot\log m)$, where $m$ is the \sidenotehighlight{size}{\draw node[anchor=north east] (target) at (-.5,-.3) {$\#\text{vertices}+\#\text{edges}+\#\text{triangles}$} (mymark) to[out=-90,in=10] ([yshift=-7pt]target.north east);} of the $2$-skeleton of $\mathcal{M}$.
\end{itemize}
\vspace{.4cm}
\textbf{Parallel.}
\end{frame*}

\subsection{Geometry of critical points}
\begin{frame*}
There are three kinds of critical points:
\begin{itemize}
\item \textcolor{gray}{(local)} \textbf{maxima}\\
$\leadsto$ $\Link^+$ empty;
\item \textcolor{gray}{(local)} \textbf{minima}\\
$\leadsto$ $\Link^-$ empty;
\item \textbf{saddles}\\
$\leadsto$ $\Link^-$ or $\Link^+$ disconnected.
\end{itemize}
\begin{columns}[T,onlytextwidth]
\begin{column}{.65\textwidth}
\begin{block}{How to detect them on a PL manifold?}
Given a vertex $v$, the \defterm{star} of $v$ is the union of all simplices containing $v$.\\
The \defterm{link} of $v$ is the boundary of its star.
\begin{align*}
\Link^+(v)&=\left\{x\in\Link(v):f(x)>f(v)\right\}\\
\Link^-(v)&=\left\{x\in\Link(v):f(x)<f(v)\right\}\\
\end{align*}
\end{block}
\end{column}
\begin{column}{.35\textwidth}
\end{column}
\end{columns}
\end{frame*}

\subsection*{Significance of critical points}
\begin{frame*}
The critical points of $f$ are closely related to the topology of the Reeb graph $\mathcal{R}(f)$.
\begin{itemize}
\item \textbf{Maxima} and \textbf{minima}\\
$\leadsto$ nodes of valence $1$ (leaves).
\item \textbf{Saddles}\\
$\leadsto$ nodes of valence $\ge 2$.\\
\begin{itemize}
\item \textbf{Join saddles}: multiple components below.\tikzmarknode{prev}{}
\item \textbf{Split saddles}: multiple components above.\sidenote{}{\draw[-,decorate,decoration={brace,mirror}] ($(mymark)+(.3em,-.3em)$) -- node[right,inner xsep=10pt,align=left] {non-mutually exclusive\\in dimension $\ge 3$} ($(mymark |- prev)+(.3em,1em)$);}
\end{itemize}
\end{itemize}
\end{frame*}