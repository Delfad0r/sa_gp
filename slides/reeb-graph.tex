\section{Reeb graph}

\subsection{Definition}
\begin{frame*}
Given:
\begin{itemize}
\item<1-> a manifold $\mathcal{M}$;
\item<2-> a Morse function $\map{f}{\mathcal{M}}{\RR}$ with distinct critical values;
\end{itemize}
\onslide<3->{
the \defterm{Reeb graph} of $f$ is the $1$-dimensional simplicial complex
\[
\mathcal{R}(f)=\mathcal{M}/\sidenote<4>[text height=height("I"))]{\sim}{\draw node[draw,circle,inner sep=5pt] (source)  {} node[text width=4cm,anchor=north west] (target) at (.3,-.3) {$x\sim y$ if $f(x)=f(y)$ and they belong to the same connected component of $f^{-1}(f(x))$} (source) to[out=-90,in=170] ([yshift=-7pt]target.north west);}.
\]
}
\onslide<5->{
The \defterm{segmentation map} is the quotient map
\[
\map{\Phi}{\mathcal{M}}{\mathcal{R}(f)}.
\]
}
\vspace{-.9cm}
\begin{center}
\tikzexternalenable
\begin{tikzpicture}
\colorlet{topcolor}{gray!40!white!30!red}
\colorlet{bottomcolor}{gray!40!white!30!blue}
\def\preimageh{19}
\tikzmath{\hpercent=int(\preimageh/25*100);}
\colorlet{preimagecol}{topcolor!\hpercent!bottomcolor}
\path (-2,-.1) rectangle (6.5,3.3);
\begin{scope}[small,transform canvas={scale=.5}]
\begin{onlyenv}<2->
\begin{scope}[shift={(-12,0)}]
\draw[black,line width=2pt] (-1.5pt,0) rectangle (1.5pt,25);
\path[decorate,decoration={markings,mark=at position 1 with{\arrow{Latex[line width=1pt,fill=topcolor,scale=3]};}}] (0,0) to node[left,scale=2] {$f$} ($(0,25)+(0,13pt)$);
\fill[top color=topcolor,bottom color=bottomcolor] (-1.5pt,0) rectangle (1.5pt,25);
\scoped[shift={(0,\preimageh)}]\draw[visible on=<4>,line width=1pt,fill=preimagecol] coordinate (level set l) (-4pt,-4pt) rectangle (4pt,4pt);
\end{scope}
\end{onlyenv}
\draw[visible on=<5>,line width=1pt,-{To[scale]}] (20,12.5) -- node[above,scale=2] {$\Phi$} (27,12.5);
\alt<2>{\pic{reeb graph={manifold 1,contour,background={\fill[top color=topcolor,bottom color=bottomcolor] (bbox.south west) rectangle (bbox.north east);}}};}
{\pic{reeb graph={manifold 1,manifold bg,/tikz/only=<4>{
partial edge={12}{}{absolute up to={\preimageh}{\draw[preimagecol,line width=2pt,dashed,opacity=.5] (.1,0) arc(0:180:1.6 and .5);\draw[preimagecol,line width=2pt] (.1,0) arc (0:-180:1.6 and .5);}},
partial edge={11}{}{absolute up to={\preimageh}{\draw[preimagecol,line width=2pt,dashed,opacity=.5] (1.5,0) arc(0:180:1.5 and .5);\draw[preimagecol,line width=2pt] (1.5,0) arc (0:-180:1.5 and .5);}},
partial edge={10}{}{absolute up to={\preimageh}{\draw[preimagecol,line width=2pt,dashed,opacity=.5] (2.0,0) arc(0:180:1.2 and .5);\draw[preimagecol,line width=2pt] (2.0,0) arc(0:-180:1.2 and .5);}},
},/tikz/only=<5>{every segment={\fillsegmentcmd}}}};}
\begin{scope}[xshift=8cm]
\begin{onlyenv}<3->
\pic{reeb graph={manifold 1,every edge={preaction={draw=black,line width=3pt},/tikz/alt=<5>{draw=\thiscolor}{draw=gray!40},line width=2pt},every node={\draw[black,line width=1pt,fill=white] circle(3pt);},/tikz/only=<4>{
partial edge={12}{}{absolute up to={\preimageh}{\fill[preimagecol] circle(3pt);}},
partial edge={11}{}{absolute up to={\preimageh}{\fill[preimagecol] circle(3pt);}},
partial edge={10}{}{absolute up to={\preimageh}{\fill[preimagecol] coordinate (level set r) circle(3pt);}},}
}};
\end{onlyenv}
\end{scope}
\only<4>{\scoped[on background layer={transform canvas={scale=.5}}]\draw[line width=1,preimagecol,dashed] (level set l) -- (level set r);}
\end{scope}
\end{tikzpicture}
\tikzexternaldisable
\end{center}
\end{frame*}

\subsection*{Desired algorithm}
\begin{frame*}
\begin{columns}[T,onlytextwidth]
\begin{column}{.7\textwidth}
\textbf{Input:}
\begin{itemize}
\item {\only<2->{\color{gray}}a PL manifold $\mathcal{M}$}\\
\onslide<2->{$\leadsto$ a triangulated mesh $\mathcal{M}$;}
\item<3-> {\only<4->{\color{gray}}a non-degenerate PL scalar field $f$ on $\mathcal{M}$}\\
\onslide<4->{$\leadsto$ a \sidenotehighlight<4>{scalar value}{\draw node[anchor=north west,text width=4cm] (target) at (.5, -.3) {pairwise different, in order to ensure non-degeneracy; this can be achieved by random perturbations} (mymark) to[out=-90,in=170] ([yshift=-7pt]target.north west);} $f(v)$ for each vertex $v$ of $\mathcal{M}$.}
\end{itemize}
\vspace{.4cm}
\onslide<5->{
\textbf{Output:}
\begin{itemize}
\item the \sidenotehighlight<5>{augmented}{\draw node[anchor=north west] (target) at (.5,-.3) {graph $+$ segmentation map} (mymark) to[out=-90,in=170] ([yshift=-7pt]target.north west);} Reeb graph $\mathcal{R}(f)$.
\end{itemize}
}
\end{column}
\begin{column}{.3\textwidth}
\tikzexternalenable
\begin{tikzpicture}
\colorlet{topcolor}{gray!40!white!30!red}
\colorlet{bottomcolor}{gray!40!white!30!blue}
\path(0,0) rectangle(3,3.5);
\begin{scope}[small,transform canvas={scale=.5},shift={(6,1)}]
\only<1-2>{\pic{reeb graph={manifold 1,manifold bg}};}
\only<3-4>{\pic{reeb graph={manifold 1,contour,background={\fill[top color=topcolor,bottom color=bottomcolor] (bbox.south west) rectangle (bbox.north east);}}};}
\only<5->{\pic{reeb graph={manifold 1,contour, every segment={\fillsegmentcmd},every edge={preaction={draw=white,line width=3pt},draw=\thiscolor,line width=2pt},every node={\draw[black,line width=1pt,fill=white] circle(3pt);}}};}
\end{scope}
\end{tikzpicture}
\tikzexternaldisable
\end{column}
\end{columns}
\vspace{.4cm}
\onslide<6->{
\textbf{Time complexity:}
\begin{itemize}
\item $O(m\cdot\log m)$, where $m$ is the \sidenotehighlight<6>{size}{\draw node[anchor=north east] (target) at (-.5,-.3) {$\#\text{vertices}+\#\text{edges}+\#\text{triangles}$} (mymark) to[out=-90,in=10] ([yshift=-7pt]target.north east);} of the $2$-skeleton of $\mathcal{M}$.
\end{itemize}
}
\vspace{.4cm}
\onslide<7->{
\textbf{Parallel.}
}
\end{frame*}

\subsection{Geometry of critical points}
\begin{frame*}
There are three kinds of critical points:
\begin{itemize}
\item \textcolor{gray}{(local)} \textbf{maxima}\\
$\leadsto$ $\Link^+$ empty;
\item \textcolor{gray}{(local)} \textbf{minima}\\
$\leadsto$ $\Link^-$ empty;
\item \textbf{saddles}\\
$\leadsto$ $\Link^-$ or $\Link^+$ disconnected.
\end{itemize}
\begin{columns}[T,onlytextwidth]
\begin{column}{.65\textwidth}
\begin{block}{How to detect them on a PL manifold?}
Given a vertex $v$, the \defterm{star} of $v$ is the union of all simplices containing $v$.\\
The \defterm{link} of $v$ is the boundary of its star.
\begin{align*}
\Link^+(v)&=\left\{x\in\Link(v):f(x)>f(v)\right\}\\
\Link^-(v)&=\left\{x\in\Link(v):f(x)<f(v)\right\}\\
\end{align*}
\end{block}
\end{column}
\begin{column}{.35\textwidth}
\end{column}
\end{columns}
\end{frame*}

\subsection*{Significance of critical points}
\begin{frame*}
The critical points of $f$ are closely related to the topology of the Reeb graph $\mathcal{R}(f)$.
\begin{itemize}
\item \textbf{Maxima} and \textbf{minima}\\
$\leadsto$ nodes of valence $1$ (leaves).
\item \textbf{Saddles}\\
$\leadsto$ nodes of valence $\ge 2$.\\
\begin{itemize}
\item \textbf{Join saddles}: multiple components below.\tikzmarknode{prev}{}
\item \textbf{Split saddles}: multiple components above.\sidenote{}{\draw[-,decorate,decoration={brace,mirror}] ($(mymark)+(.3em,-.3em)$) -- node[right,inner xsep=10pt,align=left] {non-mutually exclusive\\in dimension $\ge 3$} ($(mymark |- prev)+(.3em,1em)$);}
\end{itemize}
\end{itemize}
\end{frame*}