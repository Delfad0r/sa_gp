% !TeX spellcheck = en_UK

\documentclass[10pt]{beamer}
\usepackage{mystyle}

\includeonly{}
\begin{document}

\include{reeb-graph}
\include{sequential-algorithm}

\section{Parallel algorithm}

\subsection*{Core ideas}
\begin{frame*}
\begin{itemize}
\item[{\tikz\node[inner sep=0,opacity=.5]{\usebeamertemplate**{itemize item}};}] \textcolor{gray}{\textbf{Sequential}: single procedure sweeping all the vertices sequentially.}
\item \textbf{Parallel}: multiple procedures (local growths) running simultaneously.
\begin{itemize}
\item A local growth is started at every minimum.
\item Each local growth explores the mesh with an ordered BFS.
\item Each local growth updates its own preimage graph $G_r$.
\item \textbf{Join saddles}: wait until all involved local growths have reached the saddle, then join them.
\item \textbf{Split saddles}: the new open edges in $\mathcal{R}(f)$ are handled by the same local growth.
\end{itemize}
\end{itemize}
\end{frame*}

\subsection*{Local growths}
\begin{frame*}
\begin{block}{Data structures}
Each local growth keeps:
\begin{itemize}
\item a \sidenotehighlight{\textbf{Fibonacci heap}}{\draw node[anchor=north west] (target) at (.5,-.3) {can be merged in $O(1)$} (mymark) to[out=-90,in=170] ([yshift=-7pt]target.north west);} $\theta$ to store candidates for the ordered BFS.
\item an \sidenotehighlight{\textbf{ST-tree}}{\draw node[anchor=north west] (target) at (.5,-.3) {can be merged in $O(1)$} (mymark) to[out=-90,in=170] ([yshift=-7pt]target.north west);} $G_r$ to store the preimage graph. 
\end{itemize}
\end{block}
\begin{block}{Procedure}
\begin{procedure}[H]
\SetKwProg{Procedure}{procedure}{}{end}
\SetKwFunction{LocalGrowth}{LocalGrowth}
\Procedure{\LocalGrowth{$v_0$, $\mathcal{R}$, $\Phi$}}{
    $\theta$, $G_r$ $\leftarrow$ $\{v_0\}$ \textcolor{gray}{[Fibonacci heap]}, $\emptyset$ \textcolor{gray}{[ST-tree]}\;
    \While{$\theta$ is not empty}{
        $v$ $\leftarrow$ vertex in $\theta$ with minimal $f$ value\;
        
    }
}
\end{procedure}
\end{block}
\end{frame*}
\end{document}